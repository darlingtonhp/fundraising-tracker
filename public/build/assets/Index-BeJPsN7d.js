import{r as h,W as E,j as e,a as F,y as A}from"./app-Bp2RtXpQ.js";import{A as M}from"./AuthenticatedLayout-DuNq7-2H.js";import{I as u,T as R}from"./TextInput-DjZIdFdo.js";import{I as b}from"./InputLabel-CkJUODWM.js";import"./transition-BWKuXZR1.js";const B=({data:s})=>{var t,a,d;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-800 dark:text-blue-300",children:"Total Contributors"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:s.total_contributors})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-800 dark:text-green-300",children:"Total Amount Raised"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:["$",(t=s.total_amount)==null?void 0:t.toFixed(2)]})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-purple-800 dark:text-purple-300",children:"Average Contribution"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:["$",(a=s.average_contribution)==null?void 0:a.toFixed(2)]})]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 dark:text-yellow-300",children:"Total T-Shirts"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:s.total_tshirts})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-orange-800 dark:text-orange-300",children:"Total Cement Bags"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:s.total_cement_bags})]}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-indigo-800 dark:text-indigo-300",children:"T-Shirt Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:["$",(d=s.tshirt_revenue)==null?void 0:d.toFixed(2)]})]})]})},I=({data:s})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Mutupo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Contributors"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"T-Shirts"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Cement Bags"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Average"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map((t,a)=>{var d,n;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:t.mutupo_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.contributor_count}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 dark:text-green-400 font-semibold",children:["$",(d=t.total_amount)==null?void 0:d.toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.total_tshirts}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.total_cement_bags}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:["$",(n=t.average_contribution)==null?void 0:n.toFixed(2)]})]},a)})})]})}),L=({data:s})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Contributor Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Contributors"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Average"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map((t,a)=>{var d,n;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:t.contributor_type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.contributor_count}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 dark:text-green-400 font-semibold",children:["$",(d=t.total_amount)==null?void 0:d.toFixed(2)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:["$",(n=t.average_contribution)==null?void 0:n.toFixed(2)]})]},a)})})]})}),O=({data:s})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Period"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Contributors"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"T-Shirts"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Cement Bags"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map((t,a)=>{var d;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:t.period}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.contributor_count}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 dark:text-green-400 font-semibold",children:["$",(d=t.total_amount)==null?void 0:d.toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.total_tshirts}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.total_cement_bags})]},a)})})]})}),P=({data:s})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Contributor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Mutupo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"T-Shirts"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Cement Bags"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.map((t,a)=>{var d;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:t.contributor_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.mutupo}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.contributor_type}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[t.no_of_tshirts," ($",t.tshirt_amount,")"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[t.no_of_cement_bags," ($",t.cement_amount,")"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 dark:text-green-400 font-semibold",children:["$",(d=t.total_contributed)==null?void 0:d.toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.contribution_date})]},a)})})]})});function W({auth:s,reportData:t}){var k,w;const[a,d]=h.useState(t||null),[n,p]=h.useState(!1),[j,f]=h.useState(!1),{data:l,setData:m,errors:g,processing:T}=E({report_type:"summary",start_date:"",end_date:""}),y=[{value:"summary",label:"Summary Report",description:"Overview of total contributions and key metrics"},{value:"mitupo",label:"By Mutupo",description:"Contributions grouped by mutupo/totem"},{value:"contributor_type",label:"By Contributor Type",description:"Contributions by guest type"},{value:"monthly",label:"Monthly Breakdown",description:"Contributions by month"},{value:"detailed",label:"Detailed Report",description:"Complete list of all contributions"}],C=r=>{r.preventDefault(),p(!0),A.post(route("reports.generate"),l,{preserveScroll:!0,onSuccess:i=>{i.props.reportData&&d(i.props.reportData),p(!1)},onError:i=>{console.error("Validation errors:",i),p(!1)}})},S=async r=>{f(!0);try{const i=new FormData;i.append("report_type",l.report_type),i.append("start_date",l.start_date),i.append("end_date",l.end_date),i.append("format",r);const o=await fetch(route("reports.export"),{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:i});if(o.ok){const c=o.headers.get("content-disposition");let N=`report_${l.report_type}_${new Date().toISOString().split("T")[0]}.${r}`;if(c){const _=c.match(/filename="(.+)"/);_&&(N=_[1])}const D=await o.blob(),v=window.URL.createObjectURL(D),x=document.createElement("a");x.href=v,x.download=N,document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(v)}else{const c=await o.text();throw console.error("Export error:",c),new Error(`Export failed: ${o.status} ${o.statusText}`)}}catch(i){console.error("Error exporting report:",i),alert(`Error exporting report: ${i.message}. Please check the console for details.`)}finally{f(!1)}},$=()=>{if(!a||!a.data)return null;switch(a.report_type){case"summary":return e.jsx(B,{data:a.data});case"mitupo":return e.jsx(I,{data:a.data});case"contributor_type":return e.jsx(L,{data:a.data});case"monthly":return e.jsx(O,{data:a.data});case"detailed":return e.jsx(P,{data:a.data});default:return e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No report data available for this report type."})}};return e.jsxs(M,{user:s.user,header:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Reports"})}),children:[e.jsx(F,{title:"Reports"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Generate Report"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"report_type",value:"Report Type *"}),e.jsx("select",{id:"report_type",value:l.report_type,onChange:r=>m("report_type",r.target.value),className:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",children:y.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),e.jsx(u,{message:g.report_type,className:"mt-2"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:(k=y.find(r=>r.value===l.report_type))==null?void 0:k.description})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"start_date",value:"Start Date"}),e.jsx(R,{id:"start_date",type:"date",value:l.start_date,onChange:r=>m("start_date",r.target.value),className:"mt-1 block w-full"}),e.jsx(u,{message:g.start_date,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"end_date",value:"End Date"}),e.jsx(R,{id:"end_date",type:"date",value:l.end_date,onChange:r=>m("end_date",r.target.value),className:"mt-1 block w-full"}),e.jsx(u,{message:g.end_date,className:"mt-2"})]})]}),e.jsx("div",{className:"mt-6 flex justify-end space-x-3",children:e.jsx("button",{type:"submit",disabled:n||T,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-blue-400 text-white px-6 py-2 rounded shadow transition-all",children:n?"Generating...":"Generate Report"})})]})]})}),a&&e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:(w=y.find(r=>r.value===a.report_type))==null?void 0:w.label}),a.start_date||a.end_date?e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Period: ",a.start_date||"Start"," to"," ",a.end_date||"End"]}):null]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:()=>S("csv"),disabled:j,className:"bg-green-500 hover:bg-green-600 disabled:bg-green-400 text-white px-4 py-2 rounded text-sm transition-all",children:j?"Exporting...":"Export CSV"})})]}),$()]})})]})})]})}export{W as default};
